var _util=OT2.Util;OT2.Global={initPage:function(){this.goTop(),this.searchMenu(),this.topNavMenu(),this.topheadMenu(),this.toggleSearchTypes();var i=this;$(function(){i.strcut(),"function"==typeof user_news&&user_news()})},goTop:function(i){var t=1200;"undefined"!=typeof SIZE&&(t="XL"==SIZE?1200:1e3);var n=i,o=function(){var i=$(window).width();if(i>t){var o=(i-t)/2-70;n.css("right",o+"px")}};n||((n=$('<a class="return" href="javascript:;"><i class="icona-top"></i></a>')).appendTo(document.body),o()),n.on("click",function(){n.hide(),void 0===window.dispatchEvent?$("html, body").scrollTop(0):$("html, body").animate({scrollTop:0},"fast")});var e=$(window).height();$(window).on("scroll",function(){H=Math.max.call(null,document.documentElement.scrollTop,document.body.scrollTop),n[H>e/2?"show":"hide"]()}),$(window).on("resize",o)},searchMenu:function(){var i=$("#J_SearchMenu"),t=i.find(".select-items"),n=i.find(".J_tit");i.hover(function(){t.show()},function(){t.hide()}),i.on("click","a",function(){var i=$(this);i.find("input").prop("checked",!0);var o=$.trim(i.find("input").val());o=0===o.indexOf("/")?o:"/"+o,i.parents().find("form").attr({action:o});var e=i.find("span").text();n.text(e),t.hide()})},topNavMenu:function(){var i=$(".nav-items"),t=i.find(".item-list");_util.dropList(i,t,500)},topheadMenu:function(){$(".topbar-dropmap").each(function(){var i=$(this).find(".drop-bd");_util.dropList($(this),i,300)})},toggleSearchTypes:function(){var i=$('<span class="show-more">更多<i></i></span>'),t=function(t){var n=$(t),o=n.hasClass("expand-mode");if(n.find(".con-items").height()<=40)return!0;var e=i.clone().appendTo(t);e.on("click",function(){n[(o=!o)?"addClass":"removeClass"]("expand-mode")}),n.find(".type-active").position().top>5&&!o&&e.trigger("click")};$(".search-type").find("div.type-con").each(function(){t(this)}),$(".tag-type").find("div.tag-con").each(function(){t(this)})},strcut:function(){$("[data-cut]").each(function(){var i=parseInt($(this).data("cut"),10),t=$(this).text();t.length>i&&($(this).text(t.substr(0,i)+"..."),$(this).attr("title",t))})},initLogin:function(i){return void 0!==USER.uid&&0!=USER.uid?!i||(window.location=i,!1):void 0!==this.LoginModal?(this.LoginModal.formObj.clearError(),this.LoginModal.show(i),!1):(this.LoginModal={init:function(){var i=this;return this.$el=$("#Login_Pal"),this.$form=this.$el.find(".reg-form").first(),OT2.UserForm.initPlaceholder(),this.formObj=new OT2.UserForm.Login,this.formObj.$form=this.$el.find("#J_LoginForm"),this.formObj.init(),this.$form.find(".checkbox").each(function(){new OT2.Element.checkbox(this).bindEvent()}),this.$form.find(".J_CloseForm").on("click",function(){i.$el.hide()}),this},show:function(i){this.$el.show();var t=document.body.scrollTop||document.documentElement.scrollTop,n=($(window).height()-this.$form.height())/2;this.$form.css("top",t+n),this.formObj.returnurl=i}},this.LoginModal.init().show(i),!1)}},OT2.Global.initPage();